<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Laravel 11.x 控制台 - Joker-desire's Blog</title><meta name=Description content="为什么要努力？ 因为我喜欢的东西都很贵，我想去的地方都很远，我爱的人超完美。"><meta property="og:url" content="https://Joker-desire.github.io/2024/06/console/">
<meta property="og:site_name" content="Joker-desire's Blog"><meta property="og:title" content="Laravel 11.x 控制台"><meta property="og:description" content="原文 介绍 Artisan 是 Laravel 附带的命令行界面。 Artisan 作为 artisan 脚本存在于应用程序的根目录中，提供了许多有用的命令，可以在构建应用程序时使用。 要查看所有可用 Artisan 命令的"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-06-18T09:39:25+08:00"><meta property="article:modified_time" content="2024-06-18T09:39:25+08:00"><meta property="article:tag" content="PHP"><meta property="article:tag" content="Laravel"><meta property="og:image" content="https://Joker-desire.github.io/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://Joker-desire.github.io/logo.png"><meta name=twitter:title content="Laravel 11.x 控制台"><meta name=twitter:description content="原文 介绍 Artisan 是 Laravel 附带的命令行界面。 Artisan 作为 artisan 脚本存在于应用程序的根目录中，提供了许多有用的命令，可以在构建应用程序时使用。 要查看所有可用 Artisan 命令的"><meta name=application-name content="Joker-desire"><meta name=apple-mobile-web-app-title content="Joker-desire"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://Joker-desire.github.io/2024/06/console/><link rel=prev href=https://Joker-desire.github.io/2024/06/laravel11%E6%97%A5%E5%BF%97/><link rel=next href=https://Joker-desire.github.io/2024/06/aop/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Laravel 11.x 控制台","inLanguage":"zh-cn","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/Joker-desire.github.io\/2024\/06\/console\/"},"genre":"posts","keywords":"PHP, Laravel","wordcount":5817,"url":"https:\/\/Joker-desire.github.io\/2024\/06\/console\/","datePublished":"2024-06-18T09:39:25+08:00","dateModified":"2024-06-18T09:39:25+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Joker-desire"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Joker-desire's Blog"><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw' aria-hidden=true></i></span>welcome</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts title=所有文章>所有文章 </a><a class=menu-item href=/categories title=分类>分类 </a><a class=menu-item href=/tags title=标签>标签 </a><a class=menu-item href=/about title=关于>关于 </a><a class=menu-item href=https://github.com/Joker-desire title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Joker-desire's Blog"><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw' aria-hidden=true></i></span>welcome</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts title=所有文章>所有文章</a><a class=menu-item href=/categories title=分类>分类</a><a class=menu-item href=/tags title=标签>标签</a><a class=menu-item href=/about title=关于>关于</a><a class=menu-item href=https://github.com/Joker-desire title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i></a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Laravel 11.x 控制台</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Joker-desire</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/php/><i class="far fa-folder fa-fw" aria-hidden=true></i>PHP</a>&nbsp;<a href=/categories/laravel/><i class="far fa-folder fa-fw" aria-hidden=true></i>Laravel</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024年06月18日>2024年06月18日</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 5817 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 12 分钟&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#介绍>介绍</a><ul><li><a href=#tinkerpepl>Tinker（PEPL）</a><ul><li><a href=#安装>安装</a></li><li><a href=#用法>用法</a></li><li><a href=#命令允许列表>命令允许列表</a></li><li><a href=#禁止使用别名的类>禁止使用别名的类</a></li></ul></li></ul></li><li><a href=#编写命令>编写命令</a><ul><li><a href=#生成命令>生成命令</a></li><li><a href=#命令结构>命令结构</a><ul><li><a href=#退出代码>退出代码</a></li></ul></li><li><a href=#闭包命令>闭包命令</a><ul><li><a href=#类型提示依赖项>类型提示依赖项</a></li><li><a href=#闭包命令说明>闭包命令说明</a></li></ul></li><li><a href=#可分离的命令>可分离的命令</a><ul><li><a href=#lock-id>Lock ID</a></li><li><a href=#lock-过期时间>Lock 过期时间</a></li></ul></li></ul></li><li><a href=#定义输入期望>定义输入期望</a><ul><li><a href=#参数>参数</a></li><li><a href=#选项>选项</a><ul><li><a href=#带值的选项>带值的选项</a></li><li><a href=#选项快捷方式>选项快捷方式</a></li></ul></li><li><a href=#输入数组>输入数组</a><ul><li><a href=#选项数组>选项数组</a></li></ul></li><li><a href=#输入说明>输入说明</a></li><li><a href=#提示输入缺失>提示输入缺失</a></li></ul></li><li><a href=#命令io>命令I/O</a><ul><li><a href=#检索输入>检索输入</a></li><li><a href=#输入提示>输入提示</a><ul><li><a href=#要求确认>要求确认</a></li><li><a href=#自动完成>自动完成</a></li><li><a href=#多项选择>多项选择</a></li></ul></li><li><a href=#写入输出>写入输出</a><ul><li><a href=#tables>Tables</a></li><li><a href=#进度条>进度条</a></li></ul></li></ul></li><li><a href=#注册命令>注册命令</a></li><li><a href=#以编程方式执行命令>以编程方式执行命令</a><ul><li><ul><li><a href=#传递数组值>传递数组值</a></li><li><a href=#传递布尔值>传递布尔值</a></li><li><a href=#排队artisan命令>排队Artisan命令</a></li></ul></li><li><a href=#从其他命令调用命令>从其他命令调用命令</a></li></ul></li><li><a href=#信号处理>信号处理</a></li><li><a href=#存根定制>存根定制</a></li><li><a href=#事件>事件</a></li></ul></li></ul></nav></div></div><div class=content id=content><hr><p><a href=https://laravel.com/docs/11.x/artisan target=_blank rel="noopener noreffer">原文</a></p><hr><h2 id=介绍>介绍</h2><p>Artisan 是 Laravel 附带的命令行界面。</p><p>Artisan 作为 <code>artisan</code> 脚本存在于应用程序的根目录中，提供了许多有用的命令，可以在构建应用程序时使用。</p><p>要查看所有可用 Artisan 命令的列表，可以使用以下 <code>list</code> 命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php artisan list
</span></span></code></pre></td></tr></table></div></div><h3 id=tinkerpepl>Tinker（PEPL）</h3><p>Laravel Tinker 是 Laravel 框架的强大 REPL，由 PsySH 软件包提供支持。</p><h4 id=安装>安装</h4><p>默认情况下，所有的Laravel应用程序都包含Tinker。也可以手动进行安装，使用Composer进行安装：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require laravel/tinker
</span></span></code></pre></td></tr></table></div></div><h4 id=用法>用法</h4><p>Tinker 允许在命令行上于整个Laravel应用程序进行交互，包括Eloquent模型、作业、事件等。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 进入tinker环境</span>
</span></span><span class=line><span class=cl>php artisan tinker
</span></span></code></pre></td></tr></table></div></div><p>使用以下 <code>vendor:publish</code> 命令发布 Tinker 的配置文件：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php artisan vendor:publish --provider<span class=o>=</span><span class=s2>&#34;Laravel\Tinker\TinkerServiceProvider&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=命令允许列表>命令允许列表</h4><p>Tinker使用允许列表来确定允许在其shell中运行那些Artisan命令。</p><p>默认情况下，可以运行<code>clear-compiled</code>, <code>down</code>, <code>env</code>, <code>inspire</code>, <code>migrate</code>, <code>optimize</code>和 <code>up</code>命令。</p><p>如果要允许更多命令，可以将它们添加到<code>tinker.php</code>配置文件中的<code>commands</code>数组中：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=s1>&#39;commands&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=c1>// App\Console\Commands\ExampleCommand::class,
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>],</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=禁止使用别名的类>禁止使用别名的类</h4><p>通常情况下Tinker交互时，会自动为类添加别名。但是可以设置禁止某些类不添加别名。</p><p>可以通过列出<code>tinker.php</code>配置文件<code>dont_alias</code>数组中的类来实现此目的：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=s1>&#39;dont_alias&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=nx>App\Models\User</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>],</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=编写命令>编写命令</h2><p>除了 Artisan 提供的命令外，还可以构建自己的自定义命令。</p><p>命令通常存储在 <code>app/Console/Commands</code> 目录中;</p><p>但是，也可以自由选择自己的存储位置，只要命令可以由 Composer 加载即可。</p><h3 id=生成命令>生成命令</h3><blockquote><p><code>make:command</code>命令用于创建新命令。</p><p>命令将在 <code>app/Console/Commands</code> 目录中创建一个新的命令类</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php artisan make:command SendEmails
</span></span></code></pre></td></tr></table></div></div><h3 id=命令结构>命令结构</h3><p>生成命令后，应为类的 <code>signature</code> 和 <code>description</code> 属性定义适当的值。</p><p>在 <code>list</code> 屏幕上显示命令时，将使用这些属性。</p><p>该 <code>signature</code> 属性还允许定义命令的输入期望值。</p><p>执行命令时将调用该 <code>handle</code> 方法，可以将命令逻辑放在此方法中。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Console\Commands</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Console\Command</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SendEmails</span> <span class=k>extends</span> <span class=nx>Command</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>     * The name and signature of the console command.
</span></span></span><span class=line><span class=cl><span class=sd>     *
</span></span></span><span class=line><span class=cl><span class=sd>     * @var string
</span></span></span><span class=line><span class=cl><span class=sd>     */</span>
</span></span><span class=line><span class=cl>    <span class=k>protected</span> <span class=nv>$signature</span> <span class=o>=</span> <span class=s1>&#39;mail:send {user}&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>     * The console command description.
</span></span></span><span class=line><span class=cl><span class=sd>     *
</span></span></span><span class=line><span class=cl><span class=sd>     * @var string
</span></span></span><span class=line><span class=cl><span class=sd>     */</span>
</span></span><span class=line><span class=cl>    <span class=k>protected</span> <span class=nv>$description</span> <span class=o>=</span> <span class=s1>&#39;Send a marketing email to a user&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>     * Execute the console command.
</span></span></span><span class=line><span class=cl><span class=sd>     */</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>info</span><span class=p>(</span><span class=s1>&#39;Sending email to &#39;</span> <span class=o>.</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>argument</span><span class=p>(</span><span class=s1>&#39;user&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=退出代码>退出代码</h4><p>如果 <code>handle</code> 该方法未返回任何内容，并且命令执行成功，则该命令将退出并显示 <code>0</code> 退出代码，指示成功。</p><p>但是，该 <code>handle</code> 方法可以选择返回一个整数来手动指定命令的退出代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=s1>&#39;Something went wrong.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>如果想从命令中的任何方法“失败”命令，可以使用该 <code>fail</code> 方法。</p><p>该 <code>fail</code> 方法将立即终止命令的执行，并返回以下退出 <code>1</code> 代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>fail</span><span class=p>(</span><span class=s1>&#39;Something went wrong.&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=闭包命令>闭包命令</h3><p>基于闭包的命令提供了将控制台命令定义为类的替代方法。</p><p>就像路由闭包是控制器的替代方法一样，将命令闭包视为命令类的替代方法。</p><p>尽管该 <code>routes/console.php</code> 文件未定义 HTTP 路由，但它定义了应用程序中基于控制台的入口点（路由）。</p><p>在此文件中，可以使用该 <code>Artisan::command</code> 方法定义所有基于闭包的控制台命令。</p><p>该 <code>command</code> 方法接受两个参数：命令签名和接收命令参数和选项的闭包</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>Artisan</span><span class=o>::</span><span class=na>command</span><span class=p>(</span><span class=s1>&#39;mail:send {user}&#39;</span><span class=p>,</span> <span class=k>function</span> <span class=p>(</span><span class=nx>string</span> <span class=nv>$user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>info</span><span class=p>(</span><span class=s2>&#34;Sending email to: </span><span class=si>{</span><span class=nv>$user</span><span class=si>}</span><span class=s2>!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=类型提示依赖项>类型提示依赖项</h4><p>除了接收命令的参数和选项外，命令闭包还可能类型提示要从服务容器中解析的其他依赖项：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Models\User</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Support\DripEmailer</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nx>Artisan</span><span class=o>::</span><span class=na>command</span><span class=p>(</span><span class=s1>&#39;mail:send {user}&#39;</span><span class=p>,</span> <span class=k>function</span> <span class=p>(</span><span class=nx>DripEmailer</span> <span class=nv>$drip</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$drip</span><span class=o>-&gt;</span><span class=na>send</span><span class=p>(</span><span class=nx>User</span><span class=o>::</span><span class=na>find</span><span class=p>(</span><span class=nv>$user</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=闭包命令说明>闭包命令说明</h4><p>定义基于闭包的命令时，可以使用该 <code>purpose</code> 方法向命令添加说明。</p><p>当运行 <code>php artisan list</code> or <code>php artisan help</code> 命令时，将显示此说明：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>Artisan</span><span class=o>::</span><span class=na>command</span><span class=p>(</span><span class=s1>&#39;mail:send {user}&#39;</span><span class=p>,</span> <span class=k>function</span> <span class=p>(</span><span class=nx>string</span> <span class=nv>$user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span><span class=o>-&gt;</span><span class=na>purpose</span><span class=p>(</span><span class=s1>&#39;Send a marketing email to a user&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=可分离的命令>可分离的命令</h3><p>若要使用此功能，应用程序必须使用 <code>memcached</code> 、 <code>redis</code> 、 <code>dynamodb</code>、 <code>database</code> 、 <code>file</code> 或 <code>array</code> 缓存驱动程序作为应用程序的默认缓存驱动程序。此外，所有服务器必须与同一中央缓存服务器通信。</p><p>有时，可能希望确保一次只能运行一个命令实例。</p><p>为此，可以在命令类上实现该 <code>Illuminate\Contracts\Console\Isolatable</code> 接口：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Console\Commands</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Console\Command</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Contracts\Console\Isolatable</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SendEmails</span> <span class=k>extends</span> <span class=nx>Command</span> <span class=k>implements</span> <span class=nx>Isolatable</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>当命令标记为 <code>Isolatable</code> 时，Laravel 将自动向该命令添加一个 <code>--isolated</code> 选项。</p><p>当使用该选项调用命令时，Laravel 将确保该命令的其他实例尚未运行。</p><p>Laravel 通过尝试使用应用程序的默认缓存驱动程序获取原子锁来实现此目的。</p><p>如果该命令的其他实例正在运行，则不会执行该命令;但是，该命令仍将退出，并显示成功退出状态代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php artisan mail:send <span class=m>1</span> --isolated
</span></span></code></pre></td></tr></table></div></div><p>如果要指定命令在无法执行时应返回的退出状态代码，可以通过以下 <code>isolated</code> 选项提供所需的状态代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php artisan mail:send <span class=m>1</span> --isolated<span class=o>=</span><span class=m>12</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=lock-id>Lock ID</h4><p>默认情况下，Laravel 将使用命令的名称生成字符串键，该字符串键用于获取应用程序缓存中的原子锁。</p><p>但是，也可以通过在 Artisan 命令类上定义 <code>isolatableId</code> 方法来自定义此键，从而允许将命令的参数或选项集成到键中：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * Get the isolatable ID for the command.
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>isolatableId</span><span class=p>()</span><span class=o>:</span> <span class=nx>string</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>argument</span><span class=p>(</span><span class=s1>&#39;user&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=lock-过期时间>Lock 过期时间</h4><p>默认情况下，隔离锁在命令完成后过期。或者，如果命令中断且无法完成，则锁将在一小时后过期。</p><p>但是，可以通过在命令上定义 <code>isolationLockExpiresAt</code> 方法来调整锁定过期时间：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>DateTimeInterface</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>DateInterval</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * Determine when an isolation lock expires for the command.
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>isolationLockExpiresAt</span><span class=p>()</span><span class=o>:</span> <span class=nx>DateTimeInterface</span><span class=o>|</span><span class=nx>DateInterval</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>now</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>addMinutes</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=定义输入期望>定义输入期望</h2><p>编写控制台命令时，通常通过参数或选项从用户那里收集输入。</p><p>Laravel 可以非常方便地使用命令上的 <code>signature</code> 属性来定义用户期望的输入。</p><p>该 <code>signature</code> 属性允许以单个富有表现力的类似路由的语法定义命令的名称、参数和选项。</p><h3 id=参数>参数</h3><p>用户提供的所有参数和选项都用大括号括起来。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * The name and signature of the console command.
</span></span></span><span class=line><span class=cl><span class=sd> *
</span></span></span><span class=line><span class=cl><span class=sd> * @var string
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>protected</span> <span class=nv>$signature</span> <span class=o>=</span> <span class=s1>&#39;mail:send {user}&#39;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>还可以将参数设置为可选参数或定义参数的默认值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// Optional argument...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=s1>&#39;mail:send {user?}&#39;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>// Optional argument with default value...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=s1>&#39;mail:send {user=foo}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=选项>选项</h3><p>当通过命令行提供选项时，选项以两个连字符 （ <code>--</code> ） 为前缀。</p><p>有两种类型的选项：接收值的选项和不接收值的选项。</p><p>未收到值的选项充当布尔“开关”。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * The name and signature of the console command.
</span></span></span><span class=line><span class=cl><span class=sd> *
</span></span></span><span class=line><span class=cl><span class=sd> * @var string
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>protected</span> <span class=nv>$signature</span> <span class=o>=</span> <span class=s1>&#39;mail:send {user} {--queue}&#39;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>在此示例中，可以在调用 Artisan 命令时指定 <code>--queue</code> 开关。</p><p>如果传递了 <code>--queue</code> 开关，则该选项的值将为 <code>true</code> 。否则，该值将为 <code>false</code> ：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php artisan mail:send <span class=m>1</span> --queue
</span></span></code></pre></td></tr></table></div></div><h4 id=带值的选项>带值的选项</h4><p>在选项名称后加上符号 <code>=</code> 定义带值的选项：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * The name and signature of the console command.
</span></span></span><span class=line><span class=cl><span class=sd> *
</span></span></span><span class=line><span class=cl><span class=sd> * @var string
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>protected</span> <span class=nv>$signature</span> <span class=o>=</span> <span class=s1>&#39;mail:send {user} {--queue=}&#39;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>在此示例中，用户可以像这样传递选项的值。</p><p>如果在调用命令时未指定该选项，则其值将为 <code>null</code> ：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php artisan mail:send <span class=m>1</span> --queue<span class=o>=</span>default
</span></span></code></pre></td></tr></table></div></div><p>可以通过在选项名称后指定默认值来为选项分配默认值。</p><p>如果用户未传递任何选项值，则将使用默认值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=s1>&#39;mail:send {user} {--queue=default}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=选项快捷方式>选项快捷方式</h4><p>要在定义选项时指定快捷方式，可以在选项名称之前指定快捷方式，并使用字符 <code>|</code> 作为分隔符将快捷方式与完整选项名称分开：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=s1>&#39;mail:send {user} {--Q|queue}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>在终端上调用命令时，选项快捷方式应以单个连字符为前缀，并且在指定选项值时不应包含 <code>=</code> 任何字符：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php artisan mail:send <span class=m>1</span> -Qdefault
</span></span></code></pre></td></tr></table></div></div><h3 id=输入数组>输入数组</h3><p>如果要定义参数或选项以需要多个输入值，则可以使用字符 <code>*</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=s1>&#39;mail:send {user*}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>调用此方法时，可以将 <code>user</code> 参数按顺序传递到命令行。</p><p>例如，以下命令将 的 <code>user</code> 值设置为具有 <code>1</code> 和 <code>2</code> 作为其值的数组：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php artisan mail:send <span class=m>1</span> <span class=m>2</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=选项数组>选项数组</h4><p>定义需要多个输入值的选项时，传递给命令的每个选项值都应以选项名称为前缀：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=s1>&#39;mail:send {--id=*}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>可以通过传递多个 <code>--id</code> 参数来调用此类命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php artisan mail:send --id<span class=o>=</span><span class=m>1</span> --id<span class=o>=</span><span class=m>2</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=输入说明>输入说明</h3><p>可以通过使用冒号将参数名称与描述分开来为输入参数和选项分配说明。</p><p>如果需要一点额外的空间来定义命令，请随意将定义分散到多行：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * The name and signature of the console command.
</span></span></span><span class=line><span class=cl><span class=sd> *
</span></span></span><span class=line><span class=cl><span class=sd> * @var string
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>protected</span> <span class=nv>$signature</span> <span class=o>=</span> <span class=s1>&#39;mail:send
</span></span></span><span class=line><span class=cl><span class=s1>                        {user : The ID of the user}
</span></span></span><span class=line><span class=cl><span class=s1>                        {--queue : Whether the job should be queued}&#39;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=提示输入缺失>提示输入缺失</h3><p>如果命令包含必需的参数，则用户将在未提供参数时收到错误消息。</p><p>或者，也可以通过实现 <code>PromptsForMissingInput</code> 接口将命令配置为在缺少所需参数时自动提示用户：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Console\Commands</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Console\Command</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Contracts\Console\PromptsForMissingInput</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SendEmails</span> <span class=k>extends</span> <span class=nx>Command</span> <span class=k>implements</span> <span class=nx>PromptsForMissingInput</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>     * The name and signature of the console command.
</span></span></span><span class=line><span class=cl><span class=sd>     *
</span></span></span><span class=line><span class=cl><span class=sd>     * @var string
</span></span></span><span class=line><span class=cl><span class=sd>     */</span>
</span></span><span class=line><span class=cl>    <span class=k>protected</span> <span class=nv>$signature</span> <span class=o>=</span> <span class=s1>&#39;mail:send {user}&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>如果 Laravel 需要从用户那里收集所需的参数，它将通过使用参数名称或描述智能地表述问题来自动向用户询问参数。</p><p>如果希望自定义用于收集所需参数的问题，可以实现该 <code>promptForMissingArgumentsUsing</code> 方法，返回由参数名称键控的问题数组：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * Prompt for missing input arguments using the returned questions.
</span></span></span><span class=line><span class=cl><span class=sd> *
</span></span></span><span class=line><span class=cl><span class=sd> * @return array&lt;string, string&gt;
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>protected</span> <span class=k>function</span> <span class=nf>promptForMissingArgumentsUsing</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Which user ID should receive the mail?&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>还可以使用包含问题和占位符的元组来提供占位符文本：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;user&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;Which user ID should receive the mail?&#39;</span><span class=p>,</span> <span class=s1>&#39;E.g. 123&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span></code></pre></td></tr></table></div></div><p>如果要完全控制提示，可以提供一个闭包，该闭包应提示用户并返回其答案：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Models\User</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=k>function</span> <span class=nf>Laravel\Prompts\search</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;user&#39;</span> <span class=o>=&gt;</span> <span class=nx>fn</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=nx>search</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>label</span><span class=o>:</span> <span class=s1>&#39;Search for a user:&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>placeholder</span><span class=o>:</span> <span class=s1>&#39;E.g. Taylor Otwell&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>options</span><span class=o>:</span> <span class=nx>fn</span> <span class=p>(</span><span class=nv>$value</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=nx>strlen</span><span class=p>(</span><span class=nv>$value</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=o>?</span> <span class=nx>User</span><span class=o>::</span><span class=na>where</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;like&#39;</span><span class=p>,</span> <span class=s2>&#34;%</span><span class=si>{</span><span class=nv>$value</span><span class=si>}</span><span class=s2>%&#34;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>pluck</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;id&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=o>:</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span></code></pre></td></tr></table></div></div><p>如果希望提示用户选择或输入选项，可以在命令的 <code>handle</code> 方法中包含提示。</p><p>然而，如果只希望在用户因为缺少参数而被自动提示时才进行提示，那么可以实现 <code>afterPromptingForMissingArguments</code> 方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>Symfony\Component\Console\Input\InputInterface</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Symfony\Component\Console\Output\OutputInterface</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=k>function</span> <span class=nf>Laravel\Prompts\confirm</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * Perform actions after the user was prompted for missing arguments.
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>protected</span> <span class=k>function</span> <span class=nf>afterPromptingForMissingArguments</span><span class=p>(</span><span class=nx>InputInterface</span> <span class=nv>$input</span><span class=p>,</span> <span class=nx>OutputInterface</span> <span class=nv>$output</span><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$input</span><span class=o>-&gt;</span><span class=na>setOption</span><span class=p>(</span><span class=s1>&#39;queue&#39;</span><span class=p>,</span> <span class=nx>confirm</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>label</span><span class=o>:</span> <span class=s1>&#39;Would you like to queue the mail?&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=k>default</span><span class=o>:</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>option</span><span class=p>(</span><span class=s1>&#39;queue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=命令io>命令I/O</h2><h3 id=检索输入>检索输入</h3><p>在执行命令时，可能需要访问命令接受的参数和选项的值。</p><p>为此，可以使用 <code>argument</code> 和 <code>option</code> 方法。</p><p>如果参数或选项不存在， <code>null</code> 则返回：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * Execute the console command.
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>()</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$userId</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>argument</span><span class=p>(</span><span class=s1>&#39;user&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>如果需要将所有参数检索为 <code>array</code> ，请调用该 <code>arguments</code> 方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$arguments</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>arguments</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p>使用该 <code>option</code> 方法可以像检索参数一样轻松地检索选项。</p><p>若要将所有选项检索为数组，请调用以下 <code>options</code> 方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// Retrieve a specific option...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$queueName</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>option</span><span class=p>(</span><span class=s1>&#39;queue&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>// Retrieve all options as an array...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$options</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>options</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=输入提示>输入提示</h3><p>除了显示输出之外，还可以要求用户在执行命令期间提供输入。</p><p>该 <code>ask</code> 方法将提示用户给定的问题，接受他们的输入，然后将用户的输入返回到您的命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * Execute the console command.
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>()</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$name</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>ask</span><span class=p>(</span><span class=s1>&#39;What is your name?&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>该 <code>ask</code> 方法还接受可选的第二个参数，该参数指定在未提供用户输入时应返回的默认值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$name</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>ask</span><span class=p>(</span><span class=s1>&#39;What is your name?&#39;</span><span class=p>,</span> <span class=s1>&#39;Taylor&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p><code>secret</code> 方法与 <code>ask</code> 方法类似，但用户在控制台输入时输入内容不会显示给他们。</p><p>此方法在询问诸如密码等敏感信息时非常有用：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$password</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>secret</span><span class=p>(</span><span class=s1>&#39;What is the password?&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=要求确认>要求确认</h4><p>如果需要向用户询问一个简单的“是或否”确认，可以使用 <code>confirm</code> 方法。</p><p>默认情况下，此方法将返回 <code>false</code>。</p><p>然而，如果用户在提示中输入 <code>y</code> 或 <code>yes</code>，该方法将返回 <code>true</code>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>confirm</span><span class=p>(</span><span class=s1>&#39;Do you wish to continue?&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>如果需要，可以通过将 <code>true</code> 作为第二个参数传递给 <code>confirm</code> 方法，从而指定确认提示默认应返回 <code>true</code>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>confirm</span><span class=p>(</span><span class=s1>&#39;Do you wish to continue?&#39;</span><span class=p>,</span> <span class=k>true</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=自动完成>自动完成</h4><p><code>anticipate</code> 方法可用于为可能的选项提供自动完成。</p><p>用户仍然可以提供任何答案，而不管自动完成提示如何：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$name</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>anticipate</span><span class=p>(</span><span class=s1>&#39;What is your name?&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;Taylor&#39;</span><span class=p>,</span> <span class=s1>&#39;Dayle&#39;</span><span class=p>]);</span>
</span></span></code></pre></td></tr></table></div></div><p>或者，也可以将一个闭包作为第二个参数传递给 <code>anticipate</code> 方法。</p><p>每次用户输入一个字符时，都会调用该闭包。</p><p>闭包应接受一个包含用户当前输入的字符串参数，并返回一个用于自动完成的选项数组：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$name</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>anticipate</span><span class=p>(</span><span class=s1>&#39;What is your address?&#39;</span><span class=p>,</span> <span class=k>function</span> <span class=p>(</span><span class=nx>string</span> <span class=nv>$input</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Return auto-completion options...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=多项选择>多项选择</h4><p>如果需要在询问问题时向用户提供一组预定义的选项，可以使用 <code>choice</code> 方法。</p><p>如果未选择任何选项，可以通过将索引作为第三个参数传递给该方法来设置默认返回值的数组索引：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$name</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>choice</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;What is your name?&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=s1>&#39;Taylor&#39;</span><span class=p>,</span> <span class=s1>&#39;Dayle&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nv>$defaultIndex</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>此外，<code>choice</code> 方法还接受第四个和第五个可选参数，用于确定选择有效响应的最大尝试次数以及是否允许多重选择：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$name</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>choice</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;What is your name?&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=s1>&#39;Taylor&#39;</span><span class=p>,</span> <span class=s1>&#39;Dayle&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nv>$defaultIndex</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nv>$maxAttempts</span> <span class=o>=</span> <span class=k>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nv>$allowMultipleSelections</span> <span class=o>=</span> <span class=k>false</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=写入输出>写入输出</h3><p>若要将输出发送到控制台，可以使用<code>line</code>, <code>info</code>, <code>comment</code>, <code>question</code>, <code>warn</code>和 <code>error</code>方法。</p><p>这些方法中的每一种都将使用适当的 ANSI 颜色来实现其目的。</p><p><code>info</code> 方法将在控制台中显示为绿色文本：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * Execute the console command.
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>()</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>info</span><span class=p>(</span><span class=s1>&#39;The command was successful!&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><code>error</code> 方法将错误消息文本显示为红色：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=s1>&#39;Something went wrong!&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p><code>line</code>方法显示纯文本、无色文本：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>line</span><span class=p>(</span><span class=s1>&#39;Display this on the screen&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p><code>newLine</code>方法显示空行：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// Write a single blank line...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>newLine</span><span class=p>();</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>// Write three blank lines...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>newLine</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=tables>Tables</h4><p><code>table</code> 方法使正确格式化多行/多列数据变得简单。</p><p>只需要提供列名和表格数据，Laravel 会自动为您计算表格的适当宽度和高度：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Models\User</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>table</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=s1>&#39;Name&#39;</span><span class=p>,</span> <span class=s1>&#39;Email&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nx>User</span><span class=o>::</span><span class=na>all</span><span class=p>([</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;email&#39;</span><span class=p>])</span><span class=o>-&gt;</span><span class=na>toArray</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=进度条>进度条</h4><p>对于长时间运行的任务，显示一个进度条来告知用户任务的完成情况是很有帮助的。</p><p>通过使用 <code>withProgressBar</code> 方法，Laravel 将显示一个进度条，并在遍历给定的可迭代值的每次迭代时推进其进度：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Models\User</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nv>$users</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>withProgressBar</span><span class=p>(</span><span class=nx>User</span><span class=o>::</span><span class=na>all</span><span class=p>(),</span> <span class=k>function</span> <span class=p>(</span><span class=nx>User</span> <span class=nv>$user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>performTask</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>有时，可能需要对进度条的推进进行更手动的控制。</p><p>首先，定义该过程将迭代的总步数。</p><p>然后，在处理每个项目后推进进度条：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$users</span> <span class=o>=</span> <span class=nx>App\Models\User</span><span class=o>::</span><span class=na>all</span><span class=p>();</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nv>$bar</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>output</span><span class=o>-&gt;</span><span class=na>createProgressBar</span><span class=p>(</span><span class=nx>count</span><span class=p>(</span><span class=nv>$users</span><span class=p>));</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nv>$bar</span><span class=o>-&gt;</span><span class=na>start</span><span class=p>();</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$users</span> <span class=k>as</span> <span class=nv>$user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>performTask</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=nv>$bar</span><span class=o>-&gt;</span><span class=na>advance</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nv>$bar</span><span class=o>-&gt;</span><span class=na>finish</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=注册命令>注册命令</h2><p>默认情况下，Laravel 会自动注册 <code>app/Console/Commands</code> 目录中的所有命令。</p><p>但是，可以指示 Laravel 使用应用程序 <code>bootstrap/app.php</code> 文件中的方法 <code>withCommands</code> 扫描其他目录中的 Artisan 命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>-&gt;</span><span class=na>withCommands</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=no>__DIR__</span><span class=o>.</span><span class=s1>&#39;/../app/Domain/Orders/Commands&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p>还可以通过向 <code>withCommands</code> 方法提供命令的类名来手动注册命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Domain\Orders\Commands\SendEmails</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=o>-&gt;</span><span class=na>withCommands</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=nx>SendEmails</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p>当 Artisan 启动时，应用程序中的所有命令都将由服务容器解析并向 Artisan 注册。</p><h2 id=以编程方式执行命令>以编程方式执行命令</h2><p>可以使用 <code>Artisan</code> facade 上的 <code>call</code> 方法来完成从路由或控制器中执行一个Artisan命令。</p><p><code>call</code> 方法接受命令的签名名称或类名称作为第一个参数，以及一个命令参数数组作为第二个参数。返回值将是命令的退出码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\Artisan</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/user/{user}/mail&#39;</span><span class=p>,</span> <span class=k>function</span> <span class=p>(</span><span class=nx>string</span> <span class=nv>$user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$exitCode</span> <span class=o>=</span> <span class=nx>Artisan</span><span class=o>::</span><span class=na>call</span><span class=p>(</span><span class=s1>&#39;mail:send&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user&#39;</span> <span class=o>=&gt;</span> <span class=nv>$user</span><span class=p>,</span> <span class=s1>&#39;--queue&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;default&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>也可以将整个 Artisan 命令作为字符串传递 <code>call</code> 给该方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>Artisan</span><span class=o>::</span><span class=na>call</span><span class=p>(</span><span class=s1>&#39;mail:send 1 --queue=default&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=传递数组值>传递数组值</h4><p>如果命令定义了一个接受数组的选项，则可以将值数组传递给该选项：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\Artisan</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/mail&#39;</span><span class=p>,</span> <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$exitCode</span> <span class=o>=</span> <span class=nx>Artisan</span><span class=o>::</span><span class=na>call</span><span class=p>(</span><span class=s1>&#39;mail:send&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;--id&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>13</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=传递布尔值>传递布尔值</h4><p>如果需要指定不接受字符串值的选项的值（如命令上 <code>--force</code> 的标志），则应传递 <code>true</code> or <code>false</code> 作为选项的 <code>migrate:refresh</code> 值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$exitCode</span> <span class=o>=</span> <span class=nx>Artisan</span><span class=o>::</span><span class=na>call</span><span class=p>(</span><span class=s1>&#39;migrate:refresh&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;--force&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]);</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=排队artisan命令>排队Artisan命令</h4><p>通过在 <code>Artisan</code> facade 上使用 <code>queue</code> 方法，甚至可以将 Artisan 命令加入队列，以便它们在后台由队列工作者处理。</p><p>在使用此方法之前，请确保您已配置好队列并正在运行队列监听器：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>Illuminate\Support\Facades\Artisan</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/user/{user}/mail&#39;</span><span class=p>,</span> <span class=k>function</span> <span class=p>(</span><span class=nx>string</span> <span class=nv>$user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Artisan</span><span class=o>::</span><span class=na>queue</span><span class=p>(</span><span class=s1>&#39;mail:send&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user&#39;</span> <span class=o>=&gt;</span> <span class=nv>$user</span><span class=p>,</span> <span class=s1>&#39;--queue&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;default&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>通过使用 <code>onConnection</code> 和 <code>onQueue</code> 方法，可以指定 Artisan 命令应被派发到的连接或队列：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>Artisan</span><span class=o>::</span><span class=na>queue</span><span class=p>(</span><span class=s1>&#39;mail:send&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;user&#39;</span> <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;--queue&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;default&#39;</span>
</span></span><span class=line><span class=cl><span class=p>])</span><span class=o>-&gt;</span><span class=na>onConnection</span><span class=p>(</span><span class=s1>&#39;redis&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>onQueue</span><span class=p>(</span><span class=s1>&#39;commands&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=从其他命令调用命令>从其他命令调用命令</h3><p>有时，可能希望从现有的 Artisan 命令中调用其他命令。</p><p>可以使用 <code>call</code> 方法来实现。</p><p>这种 <code>call</code> 方法接受命令名称和一个包含命令参数/选项的数组：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * Execute the console command.
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>()</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>call</span><span class=p>(</span><span class=s1>&#39;mail:send&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user&#39;</span> <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;--queue&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;default&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>如果希望调用另一个控制台命令并抑制其所有输出，可以使用 <code>callSilently</code> 方法。</p><p><code>callSilently</code> 方法的签名与 <code>call</code> 方法相同：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>callSilently</span><span class=p>(</span><span class=s1>&#39;mail:send&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;user&#39;</span> <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;--queue&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;default&#39;</span>
</span></span><span class=line><span class=cl><span class=p>]);</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=信号处理>信号处理</h2><p>操作系统允许将信号发送到正在运行的进程。</p><p>例如，<code>SIGTERM</code> 信号是操作系统请求程序终止的方式。</p><p>如果需要在 Artisan 控制台命令中监听信号，并在信号发生时执行代码，可以使用 <code>trap</code> 方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * Execute the console command.
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>()</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>trap</span><span class=p>(</span><span class=nx>SIGTERM</span><span class=p>,</span> <span class=nx>fn</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>shouldKeepRunning</span> <span class=o>=</span> <span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>shouldKeepRunning</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>若要同时侦听多个信号，可以向 <code>trap</code> 该方法提供信号数组：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>trap</span><span class=p>([</span><span class=nx>SIGTERM</span><span class=p>,</span> <span class=nx>SIGQUIT</span><span class=p>],</span> <span class=k>function</span> <span class=p>(</span><span class=nx>int</span> <span class=nv>$signal</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>shouldKeepRunning</span> <span class=o>=</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=nx>dump</span><span class=p>(</span><span class=nv>$signal</span><span class=p>);</span> <span class=c1>// SIGTERM / SIGQUIT
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=存根定制>存根定制</h2><p>Artisan 控制台的 <code>make</code> 命令用于创建各种类，例如控制器、任务、迁移和测试。</p><p>这些类是使用 &ldquo;stub&rdquo; 文件生成的，这些文件根据您的输入填充值。</p><p>然而，可能希望对 Artisan 生成的文件进行一些小改动。</p><p>为此，可以使用 <code>stub:publish</code> 命令将最常用的 stubs 发布到应用程序中，以便可以对它们进行自定义：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php artisan stub:publish
</span></span></code></pre></td></tr></table></div></div><h2 id=事件>事件</h2><p>Artisan 在运行命令时会触发三个事件：<code>Illuminate\Console\Events\ArtisanStarting</code>、<code>Illuminate\Console\Events\CommandStarting</code> 和 <code>Illuminate\Console\Events\CommandFinished</code>。</p><p><code>ArtisanStarting</code> 事件在 Artisan 开始运行时立即触发。</p><p>接下来，<code>CommandStarting</code> 事件在命令运行之前立即触发。</p><p>最后，<code>CommandFinished</code> 事件在命令执行完成后触发。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2024年06月18日</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/2024/06/console/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://Joker-desire.github.io/2024/06/console/ data-title="Laravel 11.x 控制台" data-hashtags=PHP,Laravel><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://Joker-desire.github.io/2024/06/console/ data-hashtag=PHP><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Hacker News" data-sharer=hackernews data-url=https://Joker-desire.github.io/2024/06/console/ data-title="Laravel 11.x 控制台"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://Joker-desire.github.io/2024/06/console/ data-title="Laravel 11.x 控制台"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.0.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://Joker-desire.github.io/2024/06/console/ data-title="Laravel 11.x 控制台"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/php/>PHP</a>,&nbsp;<a href=/tags/laravel/>Laravel</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/2024/06/laravel11%E6%97%A5%E5%BF%97/ class=prev rel=prev title="Laravel 11.x 日志"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Laravel 11.x 日志</a>
<a href=/2024/06/aop/ class=next rel=next title="Hyperf AOP">Hyperf AOP<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app>Giscus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Joker desire</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:50},comment:{giscus:{category:"Announcements",categoryId:"DIC_kwDOHfPihs4CPp7X",darkTheme:"dark",emitMetadata:"0",inputPosition:"top",lang:"zh-CN",lazyLoading:!1,lightTheme:"light",mapping:"pathname",reactionsEnabled:"1",repo:"Joker-desire/store-comments",repoId:"R_kgDOHfPihg"}},lightgallery:!0,search:{algoliaAppID:"R6OIVCXBNU",algoliaIndex:"Joker-desire",algoliaSearchKey:"07e68b90760663e43882d4a48e00e932",highlightTag:"em",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>